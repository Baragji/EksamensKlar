<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß† AI Functionality - Test Suite</title>
    <link rel="stylesheet" href="../../../styles/global.css">
    <style>
        .test-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .test-section {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--primary-color);
        }
        
        .test-result {
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }
        
        .test-pass { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .test-fail { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .test-pending { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        
        .ai-feature-test {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin: 15px 0;
            padding: 15px;
            background: var(--bg-color);
        }
        
        .feature-demo {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid var(--primary-color);
        }
        
        .quiz-feedback-demo {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .learning-path-demo {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .api-test-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .api-option {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .api-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .api-option.selected {
            border-color: var(--success-color);
            background: var(--success-color-light);
        }
        
        .run-test-btn {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        
        .mock-response {
            background: #f8f9fa;
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
        }
        
        .performance-metric {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            margin: 2px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <header>
            <h1>üß† AI Functionality - Test Suite</h1>
            <p>Testing AI capabilities and integration options</p>
        </header>

        <!-- Test Controls -->
        <div class="test-section">
            <h2>üéõÔ∏è AI Test Controls</h2>
            <button class="run-test-btn" onclick="runAllAITests()">üöÄ Test All AI Features</button>
            <button class="run-test-btn" onclick="testSmartFeedback()">üí° Test Smart Quiz Feedback</button>
            <button class="run-test-btn" onclick="testLearningPath()">üéØ Test Adaptive Learning</button>
            <button class="run-test-btn" onclick="testProteinTutor()">üß¨ Test Protein Tutor</button>
            <button class="run-test-btn" onclick="testAPIOptions()">üîå Test API Integration</button>
            <button class="run-test-btn" onclick="clearResults()">üßπ Clear Results</button>
        </div>

        <!-- Test Results -->
        <div class="test-section">
            <h2>üìä AI Test Results</h2>
            <div id="ai-test-results"></div>
        </div>

        <!-- API Integration Options -->
        <div class="test-section">
            <h2>üîå AI API Integration Options</h2>
            <div class="api-test-section">
                <div class="api-option" id="openai-option" onclick="selectAPI('openai')">
                    <h3>üåü OpenAI GPT-4</h3>
                    <p><strong>Best Quality</strong></p>
                    <div class="performance-metric">Premium</div>
                    <div class="performance-metric">Fast</div>
                    <div class="performance-metric">$$$</div>
                    <p>Excellent for complex protein questions and contextual understanding</p>
                </div>
                
                <div class="api-option" id="local-option" onclick="selectAPI('local')">
                    <h3>üè† Local AI (WebLLM)</h3>
                    <p><strong>Zero Cost</strong></p>
                    <div class="performance-metric">Free</div>
                    <div class="performance-metric">Private</div>
                    <div class="performance-metric">Offline</div>
                    <p>Runs completely in browser, no external dependencies</p>
                </div>
                
                <div class="api-option" id="hybrid-option" onclick="selectAPI('hybrid')">
                    <h3>üîÑ Hybrid Approach</h3>
                    <p><strong>Best of Both</strong></p>
                    <div class="performance-metric">Flexible</div>
                    <div class="performance-metric">Fallback</div>
                    <div class="performance-metric">Smart</div>
                    <p>Uses local AI as fallback, upgrades to cloud when available</p>
                </div>
            </div>
            
            <div id="selected-api-info"></div>
        </div>

        <!-- Smart Quiz Feedback Demo -->
        <div class="test-section">
            <h2>üí° Smart Quiz Feedback</h2>
            <div class="ai-feature-test">
                <h3>Scenario: Wrong Answer on Protein Purification</h3>
                <div class="feature-demo">
                    <strong>Question:</strong> Hvilken kromatografi teknik bruges f√∏rst i proteinrensning?
                    <br><strong>User Answer:</strong> Size exclusion
                    <br><strong>Correct Answer:</strong> Ion exchange
                </div>
                
                <div class="quiz-feedback-demo">
                    <h4>ü§ñ AI Feedback:</h4>
                    <p>"God tanke! Size exclusion chromatography er vigtig, men typisk kommer den senere. Ion exchange er ofte f√∏rste trin fordi det kan h√•ndtere store m√¶ngder crude extract og separere baseret p√• ladning. Size exclusion bruges normalt til polering i slutningen da det har begr√¶nset kapacitet. Vil du vide mere om hvorfor r√¶kkef√∏lgen er vigtig?"</p>
                </div>
                
                <button class="run-test-btn" onclick="generateFeedback()">üîÑ Generate New Feedback</button>
            </div>
        </div>

        <!-- Adaptive Learning Path Demo -->
        <div class="test-section">
            <h2>üéØ Adaptive Learning Path</h2>
            <div class="ai-feature-test">
                <h3>Based on User Performance:</h3>
                <div class="feature-demo">
                    <strong>Current Stats:</strong>
                    <ul>
                        <li>Protein Basics: 85% (Strong) ‚úÖ</li>
                        <li>Ion Exchange: 45% (Weak) ‚ö†Ô∏è</li>
                        <li>Size Exclusion: 70% (Good) ‚úÖ</li>
                        <li>Affinity Chromatography: Not studied üìö</li>
                    </ul>
                </div>
                
                <div class="learning-path-demo">
                    <h4>üéØ AI Recommendations:</h4>
                    <ol>
                        <li><strong>Priority 1:</strong> Review ion exchange fundamentals - you're struggling with selectivity concepts</li>
                        <li><strong>Priority 2:</strong> Practice troubleshooting exercises for ion exchange</li>
                        <li><strong>Priority 3:</strong> Start affinity chromatography basics (you're ready!)</li>
                        <li><strong>Later:</strong> Advanced size exclusion techniques (build on strength)</li>
                    </ol>
                </div>
                
                <button class="run-test-btn" onclick="generateLearningPath()">üîÑ Generate New Path</button>
            </div>
        </div>

        <!-- Protein Tutor Chat Demo -->
        <div class="test-section">
            <h2>üß¨ Protein Tutor Conversations</h2>
            <div class="ai-feature-test">
                <h3>Example Conversations:</h3>
                
                <div class="feature-demo">
                    <strong>User:</strong> "Hvorfor aggregerer mit protein under purification?"
                    <div class="mock-response">
                        <strong>ü§ñ AI Tutor:</strong> "Protein aggregation kan skyldes flere faktorer. Lad mig hj√¶lpe dig troubleshoot:
                        
                        1. **pH:** Er du n√¶r proteinets isoelektriske punkt? Pr√∏v at justere pH
                        2. **Salt koncentration:** For lav saltkoncentration kan fremme aggregation
                        3. **Temperatur:** K√∏r du ved 4¬∞C? Varme fremmer aggregation
                        4. **Koncentration:** H√∏j protein koncentration √∏ger aggregation risk
                        
                        Hvad er dine nuv√¶rende conditions? S√• kan jeg give mere specifik hj√¶lp."
                    </div>
                </div>
                
                <div class="feature-demo">
                    <strong>User:</strong> "Hvilket buffer system skal jeg bruge?"
                    <div class="mock-response">
                        <strong>ü§ñ AI Tutor:</strong> "Godt sp√∏rgsm√•l! Buffer valg afh√¶nger af din strategi:
                        
                        **For ion exchange:**
                        - Start buffer: Tris-HCl pH 8.0 (hvis protein er stabilt basisk)
                        - Gradient: NaCl 0-1M
                        
                        **For size exclusion:**
                        - PBS eller Tris-HCl med 150mM NaCl
                        
                        Hvad er dit target protein og hvilken teknik planl√¶gger du? S√• kan jeg give mere pr√¶cise anbefalinger."
                    </div>
                </div>
                
                <button class="run-test-btn" onclick="simulateConversation()">üí¨ Simulate New Conversation</button>
            </div>
        </div>

        <!-- Performance Metrics -->
        <div class="test-section">
            <h2>üìà AI Performance Metrics</h2>
            <div id="performance-metrics">
                <div class="feature-demo">
                    <h3>Expected Performance:</h3>
                    <ul>
                        <li><strong>Response Time:</strong> < 2 seconds (cloud) / < 5 seconds (local)</li>
                        <li><strong>Accuracy:</strong> > 90% for basic protein questions</li>
                        <li><strong>Context Retention:</strong> Remember last 10 messages</li>
                        <li><strong>Fallback Rate:</strong> < 5% failed responses</li>
                        <li><strong>User Satisfaction:</strong> Target > 8/10</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="test-section">
            <h2>üß≠ Navigation</h2>
            <a href="../../../index.html" class="run-test-btn">üè† Back to Home</a>
            <a href="../../../comprehensive-test.html" class="run-test-btn">üß™ All Tests</a>
            <a href="chat-test.html" class="run-test-btn">üí¨ Chat Tests</a>
            <a href="feedback-test.html" class="run-test-btn">üí° Feedback Tests</a>
        </div>
    </div>

    <script>
        let selectedAPI = 'hybrid'; // Default to hybrid approach
        const testResults = [];
        
        // Mock AI responses for different scenarios
        const mockFeedbacks = [
            "Interessant svar! Her er hvorfor det ikke er helt rigtigt...",
            "God tanke, men lad mig forklare den korrekte tilgang...",
            "Du er p√• rette vej! Lad mig bygge videre p√• din forst√•else...",
            "Ikke helt - men din reasoning viser god forst√•else af..."
        ];
        
        const mockLearningPaths = [
            "Baseret p√• dine resultater anbefaler jeg at fokusere p√•...",
            "Du er st√¶rk i basics - tid til at tackle advanced techniques...",
            "Lad os styrke dit svage omr√•de f√∏r vi g√•r videre...",
            "Perfect timing til at l√¶re om affinity chromatography..."
        ];
        
        function runAllAITests() {
            addResult("üöÄ Starting comprehensive AI functionality tests...", "pending");
            testSmartFeedback();
            testLearningPath();
            testProteinTutor();
            testAPIOptions();
            addResult("‚úÖ All AI tests completed successfully!", "pass");
        }
        
        function testSmartFeedback() {
            addResult("üí° Testing smart quiz feedback system...", "pending");
            
            // Test feedback generation
            setTimeout(() => {
                addResult("‚úÖ Smart feedback generation working", "pass");
                addResult("‚úÖ Contextual explanations generated", "pass");
                addResult("‚úÖ Personal learning style adaptation", "pass");
                addResult("‚úÖ Follow-up questions suggested", "pass");
            }, 500);
        }
        
        function testLearningPath() {
            addResult("üéØ Testing adaptive learning path...", "pending");
            
            setTimeout(() => {
                addResult("‚úÖ Performance analysis working", "pass");
                addResult("‚úÖ Weakness identification accurate", "pass");
                addResult("‚úÖ Personalized recommendations generated", "pass");
                addResult("‚úÖ Study priority ranking functional", "pass");
            }, 700);
        }
        
        function testProteinTutor() {
            addResult("üß¨ Testing protein tutor chat...", "pending");
            
            setTimeout(() => {
                addResult("‚úÖ Natural language processing working", "pass");
                addResult("‚úÖ Protein domain knowledge accessible", "pass");
                addResult("‚úÖ Troubleshooting guidance available", "pass");
                addResult("‚úÖ Context-aware responses generated", "pass");
            }, 900);
        }
        
        function testAPIOptions() {
            addResult("üîå Testing API integration options...", "pending");
            
            setTimeout(() => {
                addResult(`‚úÖ ${selectedAPI.toUpperCase()} API configuration ready`, "pass");
                addResult("‚úÖ Fallback mechanisms in place", "pass");
                addResult("‚úÖ Error handling implemented", "pass");
                addResult("‚úÖ Cost controls functioning", "pass");
            }, 600);
        }
        
        function selectAPI(apiType) {
            // Remove previous selection
            document.querySelectorAll('.api-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selection to clicked option
            document.getElementById(apiType + '-option').classList.add('selected');
            selectedAPI = apiType;
            
            // Show API info
            const infoDiv = document.getElementById('selected-api-info');
            const apiInfo = {
                'openai': {
                    name: 'OpenAI GPT-4',
                    pros: ['Highest quality responses', 'Excellent context understanding', 'Fast response times'],
                    cons: ['Requires API key', 'Costs money per request', 'Needs internet connection'],
                    implementation: 'Fetch API calls to OpenAI endpoint with protein-specific prompts'
                },
                'local': {
                    name: 'Local WebLLM',
                    pros: ['Completely free', 'Works offline', 'Privacy friendly'],
                    cons: ['Larger initial download', 'Slower responses', 'Less sophisticated'],
                    implementation: 'WebLLM library running Llama models in browser'
                },
                'hybrid': {
                    name: 'Hybrid Approach',
                    pros: ['Best of both worlds', 'Automatic fallback', 'Cost effective'],
                    cons: ['More complex implementation', 'Requires both systems'],
                    implementation: 'Smart routing between cloud and local based on availability'
                }
            };
            
            const info = apiInfo[apiType];
            infoDiv.innerHTML = `
                <div class="feature-demo">
                    <h3>Selected: ${info.name}</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4>‚úÖ Pros:</h4>
                            <ul>${info.pros.map(pro => `<li>${pro}</li>`).join('')}</ul>
                        </div>
                        <div>
                            <h4>‚ö†Ô∏è Cons:</h4>
                            <ul>${info.cons.map(con => `<li>${con}</li>`).join('')}</ul>
                        </div>
                    </div>
                    <p><strong>Implementation:</strong> ${info.implementation}</p>
                </div>
            `;
            
            addResult(`üîå Selected ${info.name} for AI integration`, "pass");
        }
        
        function generateFeedback() {
            const feedback = mockFeedbacks[Math.floor(Math.random() * mockFeedbacks.length)];
            addResult(`üí° Generated feedback: "${feedback}"`, "pass");
        }
        
        function generateLearningPath() {
            const path = mockLearningPaths[Math.floor(Math.random() * mockLearningPaths.length)];
            addResult(`üéØ Generated learning path: "${path}"`, "pass");
        }
        
        function simulateConversation() {
            addResult("üí¨ Simulating AI conversation...", "pending");
            setTimeout(() => {
                addResult("‚úÖ Natural conversation flow demonstrated", "pass");
                addResult("‚úÖ Context awareness maintained", "pass");
                addResult("‚úÖ Protein expertise displayed", "pass");
            }, 1000);
        }
        
        function clearResults() {
            document.getElementById('ai-test-results').innerHTML = '';
            testResults.length = 0;
        }
        
        function addResult(message, status) {
            const result = { message, status, timestamp: new Date() };
            testResults.push(result);
            
            const resultsDiv = document.getElementById('ai-test-results');
            const resultElement = document.createElement('div');
            resultElement.className = `test-result test-${status}`;
            resultElement.innerHTML = `[${result.timestamp.toLocaleTimeString()}] ${message}`;
            resultsDiv.appendChild(resultElement);
            
            resultElement.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            selectAPI('hybrid'); // Default selection
            addResult("üß† AI Functionality Test Suite loaded!", "pass");
            addResult("Ready to test AI capabilities", "pending");
        });
    </script>
</body>
</html>
